<!DOCTYPE html>
<html lang="en" th:lang="${language}" th:class="|tw-${theme}|" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="_layout::head(~{::title}, ~{}, ~{::scripts})">
    <title th:text="#{sicknote.convert.header.title}">Krankmeldung in Abwesenheit umwandeln</title>
    <th:block th:fragment="scripts">
      <script defer asset:src="sick_note_convert.js"></script>
    </th:block>
  </head>

  <body th:replace="_layout::body(~{::main}, ~{})">
    <main th:fragment="main" class="tw-max-w-6xl tw-mx-auto tw-px-4 lg:tw-px-12 xl:tw-px-0">
      <form
        method="post"
        th:action="@{/web/sicknote/__${sickNote.id}__/convert}"
        th:object="${sickNoteConvertForm}"
        class="form-horizontal"
      >
        <div class="row">
          <div class="col-md-6">
            <div th:replace="fragments/section-heading::section-heading(~{::sicknote-convert-heading-body}, ~{})">
              <th:block th:ref="sicknote-convert-heading-body">
                <h2 th:text="#{sicknote.convert.title}">Krankmeldung in Abwesenheit umwandeln</h2>
              </th:block>
            </div>

            <div class="form-group">
              <input type="hidden" name="person" th:value="${sickNoteConvertForm.person.id}" />
              <label th:text="|#{sicknote.data.person}:|" class="control-label col-sm-12 col-md-4"></label>
              <div class="col-md-7" th:text="${sickNoteConvertForm.person.niceName}"></div>
            </div>

            <div class="form-group is-required">
              <label for="vacationType" th:text="|#{application.data.vacationType}:|" class="control-label col-md-4">
              </label>

              <div class="col-md-7">
                <select
                  th:replace="fragments/select::one(id='vacationType', name='vacationType', options=~{::sicknote-vacationtype-select-options})"
                  id="vacationType"
                >
                  <th:block th:fragment="sicknote-vacationtype-select-options">
                    <option
                      th:each="vacationType: ${vacationTypes}"
                      th:text="#{__${vacationType.messageKey}__}"
                      th:value="${vacationType.id}"
                      th:selected="${sickNoteConvertForm.vacationType != null && sickNoteConvertForm.vacationType.id == vacationType.id}"
                    ></option>
                  </th:block>
                </select>
              </div>
            </div>

            <div class="form-group">
              <input type="hidden" th:field="*{dayLength}" />
              <input type="hidden" th:field="*{startDate}" />
              <input type="hidden" th:field="*{endDate}" />

              <label class="control-label col-md-4" th:text="|#{absence.period}|"></label>

              <div class="col-md-7 tw-text-sm">
                <th:block th:if="${sickNoteConvertForm.startDate == sickNoteConvertForm.endDate}">
                  <th:block th:text="|${#messages.msg(sickNoteConvertForm.weekDayOfStartDate + '.short')}|"></th:block>,
                  <th:block th:replace="fragments/date::date(${sickNoteConvertForm.startDate})"></th:block>,&nbsp;
                  <th:block th:text="${#messages.msg(sickNoteConvertForm.dayLength)}"></th:block>
                </th:block>
                <th:block th:if="${sickNoteConvertForm.startDate != sickNoteConvertForm.endDate}">
                  <span
                    th:replace="fragments/date-range::date-range(from=${sickNoteConvertForm.startDate}, to=${sickNoteConvertForm.endDate}, pattern='E, dd.MM.yyyy')"
                  ></span>
                </th:block>
              </div>
            </div>

            <div class="form-group is-required">
              <label for="reason" class="control-label col-md-4" th:text="|#{application.data.reason}:|"></label>

              <div class="col-md-7">
                <small>
                  <span id="count-chars"></span>
                  <th:block th:text="#{action.comment.maxChars}"></th:block>
                </small>
                <textarea
                  id="reason"
                  th:field="*{reason}"
                  class="form-control"
                  th:errorclass="error"
                  rows="2"
                  onkeyup="count(this.value, 'count-chars');"
                  onkeydown="maxChars(this,200); count(this.value, 'count-chars');"
                ></textarea>
                <p
                  class="tw-mt-1 tw-text-sm tw-text-red-800 dark:tw-text-red-400"
                  th:if="${#fields.hasErrors('reason')}"
                >
                  <th:block th:errors="*{reason}">reason Error</th:block>
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-sm-12 col-md-6">
            <div th:replace="fragments/section-heading::section-heading(~{::sicknote-heading-body}, ~{})">
              <th:block th:ref="sicknote-heading-body">
                <h2 th:text="#{sicknote.title}">Krankmeldung</h2>
              </th:block>
            </div>

            <div class="box tw-p-5">
              <div th:replace="fragments/box::box-with-icon(~{::sicknote-box-icon}, ~{::sicknote-box-body})">
                <th:block th:ref="sicknote-box-icon">
                  <div
                    th:replace="fragments/rounded::block(content=~{::sicknote-box-icon-rounded}, className='tw-bg-red-500 tw-text-white dark:tw-bg-red-600 dark:tw-text-zinc-900')"
                  >
                    <th:block th:ref="sicknote-box-icon-rounded">
                      <th:block th:if="${sickNote.sickNoteType == 'SICK_NOTE_CHILD'}">
                        <svg th:replace="icon/child::svg(className='tw-w-8 tw-h-8')"></svg>&nbsp;
                      </th:block>
                      <th:block th:if="${sickNote.sickNoteType != 'SICK_NOTE_CHILD'}">
                        <svg th:replace="icon/medkit::svg(className='tw-w-8 tw-h-8')"></svg>&nbsp;
                      </th:block>
                    </th:block>
                  </div>
                </th:block>
                <th:block th:ref="sicknote-box-body">
                  <span
                    th:text="#{sicknotes.details.box.person.has(${sickNote.person.niceName})}"
                    class="tw-text-sm tw-text-black tw-text-opacity-75 dark:tw-text-zinc-300 dark:tw-text-opacity-100"
                  >
                  </span>
                  <span th:text="#{__${sickNote.sickNoteType.messageKey}__}" class="tw-my-1 tw-text-lg tw-font-medium">
                  </span>
                  <span
                    class="tw-text-sm tw-text-black tw-text-opacity-75 dark:tw-text-zinc-300 dark:tw-text-opacity-100"
                  >
                    <th:block th:if="${sickNoteConvertForm.startDate == sickNoteConvertForm.endDate}">
                      <th:block
                        th:text="|${#messages.msg(sickNoteConvertForm.weekDayOfStartDate + '.short')}|"
                      ></th:block
                      >,
                      <th:block th:replace="fragments/date::date(${sickNoteConvertForm.startDate})"></th:block>,&nbsp;
                      <th:block th:text="${#messages.msg(sickNoteConvertForm.dayLength)}"></th:block>
                    </th:block>
                    <th:block th:if="${sickNoteConvertForm.startDate != sickNoteConvertForm.endDate}">
                      <span
                        th:replace="fragments/date-range::date-range(from=${sickNoteConvertForm.startDate}, to=${sickNoteConvertForm.endDate}, pattern='E, dd.MM.yyyy')"
                      ></span>
                    </th:block>
                  </span>
                </th:block>
              </div>
            </div>

            <table class="list-table striped-table bordered-table tw-text-sm tw-mt-4">
              <tbody>
                <tr>
                  <td th:text="#{absence.period.duration}"></td>
                  <td>
                    =
                    <th:block th:replace="fragments/number::number(${sickNote.workDays})"></th:block>&nbsp;<th:block
                      th:text="#{duration.workDays}"
                    />
                  </td>
                </tr>
                <tr>
                  <td th:text="#{sicknote.data.aub.short}"></td>
                  <td>
                    <div class="tw-flex tw-items-center">
                      <th:block th:if="${sickNote.aubPresent}">
                        <svg th:replace="icon/check::svg(className='tw-w-4 tw-h-4')"></svg>
                        &nbsp;<th:block
                          th:replace="fragments/date-range::date-range(from=${sickNote.aubStartDate}, to=${sickNote.aubEndDate}, pattern='E, dd.MM.yyyy')"
                        ></th:block>
                      </th:block>
                      <th:block th:if="${not sickNote.aubPresent}">
                        <svg th:replace="icon/x-circle::svg(className='tw-w-4 tw-h-4')"></svg>
                        &nbsp;<th:block th:text="#{sicknote.data.aub.notPresent}"></th:block>
                      </th:block>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <hr />
        <button class="button-main-green col-xs-12 col-sm-5 col-md-2" th:text="#{action.save}" type="submit"></button>
        <a
          class="button col-xs-12 col-sm-5 col-md-2 pull-right"
          th:text="#{action.cancel}"
          th:href="@{/web/sicknote/__${sickNote.id}__}"
        ></a>
      </form>
    </main>
  </body>
</html>
